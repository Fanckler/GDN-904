/*
 * trans(code, replacement, domain, locale)
 */

class Translator{
    constructor(options){
        this.messages = options.messages || {};
        this.default_domain = options.defaultTranslateDomain || 'messages';
        this.fallback_locale = options.defaultLocale || 'en';
    }

    trans(code, params, domain, locale){
        params = params || {};
        domain = domain || this.default_domain;
        locale = locale || this.fallback_locale;

        if(
            this.messages[domain] === undefined
            || this.messages[domain][locale] === undefined
        ){
            return code;
        }

        code = code.split('.');
        var msg_text = this.messages[domain][locale];
        code.forEach(function(segment){
            msg_text = msg_text[segment];
        });

        if(!msg_text){
            return code.join('.');
        }

        Object.keys(params).forEach(function(key){
            if(key == '_keys') return;
            msg_text = msg_text.replace(key, params[key]);
        });

        return msg_text;
    }
}

module.exports = Translator;