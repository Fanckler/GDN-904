'use strict';

class FormRest{
    constructor(form, generator){
        this.form = form;
        this.generator = generator;
    }

    render(){
        let str = '';
        let self = this;
        Object.values(this.form).forEach((field) => {
            if(!field.rendered){
                str += self.generator.row(field);
            }
        });

        if(!this.form.methodRendered && this.form.isMainForm){
            this.form.methodRendered = true;

            let method = this.form.vars.method.toUpperCase();
            let formMethod = method;
            if(['POST', 'GET'].indexOf(method) == -1){
                formMethod = 'POST';
            }
            if(formMethod != method){
                str += `<input type="hidden" name="_method" value="${method}" />`;
            }
        }

        return str;
    }
}

module.exports = FormRest;